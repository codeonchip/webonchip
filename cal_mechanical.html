<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mechanical Engineer Calculator – Beams, Shafts, Buckling, Pressure Vessels, Springs, Gears</title>
  <style>
    :root{--bg:#0b1022;--panel:#0f172a;--panel2:#111827;--ink:#e5e7eb;--muted:#94a3b8;--accent:#22d3ee;--ok:#10b981;--warn:#f59e0b;--bad:#ef4444}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(160deg,#0b1024,#0c122b 35%,#0b0f22);color:var(--ink);font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial;display:grid;place-items:center;min-height:100vh}
    .app{width:min(1200px,96vw);background:var(--panel);border-radius:16px;box-shadow:0 12px 34px rgba(0,0,0,.55),0 0 0 1px rgba(255,255,255,.05) inset;overflow:hidden;display:grid;grid-template-columns: 270px 1px 1fr;max-height:92vh}
    .divider{background:linear-gradient(180deg,transparent,rgba(255,255,255,.08),transparent)}
    .sidebar{background:linear-gradient(180deg,#0e142b,#111827);padding:14px;display:flex;flex-direction:column;gap:10px}
    .brand{font-weight:800;letter-spacing:.06em;color:var(--accent);text-transform:uppercase;font-size:13px}
    .nav{overflow:auto}
    .nav button{width:100%;text-align:left;padding:10px 12px;border-radius:10px;background:var(--panel2);color:var(--ink);border:0;cursor:pointer;font-weight:700;margin-bottom:8px}
    .nav button[aria-current="page"]{outline:2px solid rgba(34,211,238,.4);background:#0b2d36}
    .nav small{color:var(--muted);display:block;margin-top:2px}
    .content{padding:16px 18px 24px 18px;max-height:92vh;overflow:auto}
    h1{margin:.2em 0 .6em 0;font-size:20px}
    h2{margin:1.2em 0 .4em 0;font-size:16px;color:var(--accent)}
    fieldset{border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px;margin:10px 0;background:rgba(255,255,255,.02)}
    legend{padding:0 6px;color:var(--muted)}
    label{display:flex;gap:8px;align-items:center;margin:6px 0}
    input,select{flex:1;padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);color:var(--ink);font-weight:600}
    .row{display:grid;grid-template-columns: repeat(2, minmax(0,1fr));gap:10px}
    .row3{display:grid;grid-template-columns: repeat(3, minmax(0,1fr));gap:10px}
    .row4{display:grid;grid-template-columns: repeat(4, minmax(0,1fr));gap:10px}
    .row5{display:grid;grid-template-columns: repeat(5, minmax(0,1fr));gap:10px}
    button.action{background:#0b3d4a;color:var(--ink);border:0;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer}
    .muted{color:var(--muted)}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px dashed rgba(255,255,255,.12);padding:6px 8px;text-align:right}
    th:first-child,td:first-child{text-align:left}
    .chip{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(255,255,255,.08);font-size:12px;font-weight:800}
    .note{font-size:12px;color:var(--muted)}
    .ok{color:var(--ok)}.bad{color:var(--bad)}
    .kbd{padding:1px 6px;border-radius:6px;background:rgba(255,255,255,.1);font-family:ui-monospace,Menlo,Consolas,monospace}
    #err{position:fixed;left:12px;bottom:12px;max-width:90vw;background:#3d0b12;color:#ffe3e3;border:1px solid #ef4444;padding:8px 10px;border-radius:8px;display:none;z-index:10}
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Mechanical Engineer Calculator">
    <aside class="sidebar">
      <div class="brand">Mech Eng Calculator</div>
      <div class="nav">
        <button data-view="beam" aria-current="page">Beams (deflection & stress)<br><small>Common load cases & sections</small></button>
        <button data-view="torsion">Shaft Torsion<br><small>τ, θ, polar J</small></button>
        <button data-view="buckling">Column Buckling (Euler)<br><small>P<sub>cr</sub>, λ, r</small></button>
        <button data-view="pressure">Thin‑Wall Pressure Vessels<br><small>Hoop & longitudinal</small></button>
        <button data-view="spring">Helical Springs<br><small>k, τ (Wahl)</small></button>
        <button data-view="thermal">Thermal Expansion<br><small>ΔL = αLΔT</small></button>
        <button data-view="bolts">Bolted Joint Torque<br><small>T ≈ K·F·d</small></button>
        <button data-view="gears">Gears & Speed Ratio<br><small>n, T with η</small></button>
        <button data-view="vibe">1‑DOF Natural Frequency<br><small>fₙ, ωₙ, ζ</small></button>
        <button data-view="convert">Unit Converters<br><small>Length, force, stress, torque</small></button>
      </div>
      <div class="note" style="margin-top:auto">Tip: press <span class="kbd">/</span> to jump to the first input. Assumes linear‑elastic small‑deflection theory.</div>
    </aside>
    <div class="divider"></div>

    <main class="content" id="content" tabindex="-1"></main>
  </div>

  <div id="err"></div>

<script>
// ---------- Helpers ----------
if(!Math.log10){ Math.log10 = x => Math.log(x)/Math.LN10; }
const isNum = v => Number.isFinite(v);
const content = document.getElementById('content');
const $q = sel => content.querySelector(sel);
const showErr = (msg)=>{ const e=document.getElementById('err'); e.textContent=msg; e.style.display='block'; setTimeout(()=>e.style.display='none', 5000); };
window.addEventListener('error', ev=>{ showErr('JS error: '+(ev.message||'unknown')); });

// Section properties & geometry helpers
function I_rect(b,h){ return b*h*h*h/12; }
function I_circle(d){ return Math.PI*Math.pow(d,4)/64; }
function I_tube(D,d){ return Math.PI*(Math.pow(D,4)-Math.pow(d,4))/64; }
function A_rect(b,h){ return b*h; }
function A_circle(d){ return Math.PI*d*d/4; }
function A_tube(D,d){ return Math.PI*(D*D-d*d)/4; }
function J_solid(d){ return Math.PI*Math.pow(d,4)/32; }
function J_tube(D,d){ return Math.PI*(Math.pow(D,4)-Math.pow(d,4))/32; }

// ---------- Views ----------
const views = {
  beam(){
    content.innerHTML = `
      <h1>Beam Deflection & Bending Stress</h1>
      <fieldset>
        <legend>Section</legend>
        <div class="row3">
          <label>Type
            <select id="b_sect">
              <option value="rect">Rectangle (b×h)</option>
              <option value="circle">Solid circle (d)</option>
              <option value="tube">Tube (D, d)</option>
              <option value="custom">Custom (I, c)</option>
            </select>
          </label>
          <label><span id="b_dim1l">b (m)</span>
            <input id="b_dim1" type="number" step="any" value="0.05"></label>
          <label><span id="b_dim2l">h (m)</span>
            <input id="b_dim2" type="number" step="any" value="0.10"></label>
        </div>
        <div class="row3" id="b_dim3wrap" style="display:none">
          <label>D (m) <input id="b_D" type="number" step="any" value="0.10"></label>
          <label>d (m) <input id="b_d" type="number" step="any" value="0.08"></label>
          <div></div>
        </div>
        <div class="row3" id="b_custom" style="display:none">
          <label>I (m⁴) <input id="b_Ic" type="number" step="any"></label>
          <label>c (m) <input id="b_cc" type="number" step="any"></label>
          <div></div>
        </div>
      </fieldset>
      <fieldset>
        <legend>Material & Span</legend>
        <div class="row4">
          <label>E (GPa) <input id="b_E" type="number" step="any" value="200"></label>
          <label>Length L (m) <input id="b_L" type="number" step="any" value="2"></label>
          <label>Load case
            <select id="b_case">
              <option value="ss_center">Simply supported, center point P</option>
              <option value="ss_udl">Simply supported, uniform w</option>
              <option value="cant_end">Cantilever, end point P</option>
              <option value="cant_udl">Cantilever, uniform w</option>
            </select>
          </label>
          <label><span id="b_loadlab">P (N)</span> <input id="b_load" type="number" step="any" value="1000"></label>
        </div>
      </fieldset>
      <button class="action" id="b_calc">Calculate</button>
      <h2>Results</h2>
      <div class="row4">
        <div><span class="chip">I</span> <span id="b_I">—</span> m⁴</div>
        <div><span class="chip">c</span> <span id="b_c">—</span> m</div>
        <div><span class="chip">δ<sub>max</sub></span> <span id="b_def">—</span> m</div>
        <div><span class="chip">σ<sub>max</sub></span> <span id="b_sig">—</span> Pa</div>
      </div>
      <div class="row4">
        <div><span class="chip">M<sub>max</sub></span> <span id="b_M">—</span> N·m</div>
        <div><span class="chip">w/P used</span> <span id="b_used">—</span></div>
        <div><span class="chip">Check</span> <span id="b_note">—</span></div>
        <div></div>
      </div>
    `;
    const sect=$q('#b_sect'), dim1=$q('#b_dim1'), dim2=$q('#b_dim2');
    const dim1l=$q('#b_dim1l'), dim2l=$q('#b_dim2l');
    const dim3wrap=$q('#b_dim3wrap'), cust=$q('#b_custom');
    const caseSel=$q('#b_case'), loadLab=$q('#b_loadlab');

    const refreshDims=()=>{
      const v=sect.value; dim3wrap.style.display='none'; cust.style.display='none';
      if(v==='rect'){ dim1l.textContent='b (m)'; dim2l.textContent='h (m)'; }
      else if(v==='circle'){ dim1l.textContent='d (m)'; dim2l.textContent='(unused)'; dim2.value=''; }
      else if(v==='tube'){ dim3wrap.style.display='grid'; }
      else if(v==='custom'){ cust.style.display='grid'; }
    };
    sect.addEventListener('change', refreshDims); refreshDims();
    const refreshLoad=()=>{ const m=caseSel.value.includes('udl'); loadLab.textContent = m? 'w (N/m)':'P (N)'; };
    caseSel.addEventListener('change', refreshLoad); refreshLoad();

    $q('#b_calc').onclick=()=>{
      let I=null,c=null,A=null;
      const v=sect.value; const L=+$q('#b_L').value; const E=+$q('#b_E').value*1e9; const lc=$q('#b_case').value; const q=+$q('#b_load').value;
      if(![L,E,q].every(isNum) || L<=0 || E<=0){ showErr('Check E, L, and load'); return; }
      if(v==='rect'){ const b=+dim1.value,h=+dim2.value; if(![b,h].every(isNum)||b<=0||h<=0) return showErr('Enter b,h'); I=I_rect(b,h); c=h/2; A=A_rect(b,h); }
      else if(v==='circle'){ const d=+dim1.value; if(!isNum(d)||d<=0) return showErr('Enter d'); I=I_circle(d); c=d/2; A=A_circle(d); }
      else if(v==='tube'){ const D=+$q('#b_D').value, d=+$q('#b_d').value; if(![D,d].every(isNum)||D<=d||d<=0) return showErr('Enter D>d>0'); I=I_tube(D,d); c=D/2; A=A_tube(D,d); }
      else if(v==='custom'){ I=+$q('#b_Ic').value; c=+$q('#b_cc').value; if(![I,c].every(isNum)||I<=0||c<=0) return showErr('Enter custom I,c'); }

      // Load cases: compute Mmax and deflection
      let Mmax=0, def=0, used='';
      if(lc==='ss_center'){ // simply supported center P
        const P=q; Mmax=P*L/4; def=P*Math.pow(L,3)/(48*E*I); used='P';
      } else if(lc==='ss_udl'){
        const w=q; Mmax=w*L*L/8; def=5*w*Math.pow(L,4)/(384*E*I); used='w';
      } else if(lc==='cant_end'){
        const P=q; Mmax=P*L; def=P*Math.pow(L,3)/(3*E*I); used='P';
      } else if(lc==='cant_udl'){
        const w=q; Mmax=w*L*L/2; def=w*Math.pow(L,4)/(8*E*I); used='w';
      }
      const sigma = Mmax*c/I;
      $q('#b_I').textContent=I.toExponential(5);
      $q('#b_c').textContent=c.toFixed(5);
      $q('#b_def').textContent=def.toExponential(4);
      $q('#b_sig').textContent=sigma.toFixed(2);
      $q('#b_M').textContent=Mmax.toFixed(2);
      $q('#b_used').textContent=used;
      $q('#b_note').textContent = 'Euler‑Bernoulli small deflection';
    };
  },

  torsion(){
    content.innerHTML = `
      <h1>Shaft in Torsion</h1>
      <fieldset>
        <legend>Geometry & Material</legend>
        <div class="row4">
          <label>Type
            <select id="t_type"><option value="solid">Solid round</option><option value="hollow">Hollow round</option></select>
          </label>
          <label>d (m) or D (m)<input id="t_D" type="number" step="any" value="0.04"></label>
          <label>d (inner, m) <input id="t_d" type="number" step="any" value="0"></label>
          <label>G (GPa) <input id="t_G" type="number" step="any" value="80"></label>
        </div>
        <div class="row4">
          <label>Length L (m)<input id="t_L" type="number" step="any" value="1"></label>
          <label>Torque T (N·m)<input id="t_T" type="number" step="any" value="500"></label>
          <label>Allow τ<sub>allow</sub> (MPa)<input id="t_tauallow" type="number" step="any" value="80"></label>
          <div style="display:flex;align-items:center"><button class="action" id="t_calc">Calculate</button></div>
        </div>
      </fieldset>
      <h2>Results</h2>
      <div class="row4">
        <div><span class="chip">J</span> <span id="t_J">—</span> m⁴</div>
        <div><span class="chip">τ<sub>max</sub></span> <span id="t_tau">—</span> Pa</div>
        <div><span class="chip">θ</span> <span id="t_theta">—</span> rad</div>
        <div><span class="chip">Safety</span> <span id="t_sf">—</span></div>
      </div>
    `;
    $q('#t_calc').onclick=()=>{
      const type=$q('#t_type').value, D=+$q('#t_D').value, d=+$q('#t_d').value;
      const G=+$q('#t_G').value*1e9, L=+$q('#t_L').value, T=+$q('#t_T').value, tauA=+$q('#t_tauallow').value*1e6;
      if(![D,G,L,T,tauA].every(isNum) || D<=0 || G<=0 || L<=0) return showErr('Check inputs');
      let J, r;
      if(type==='solid'){ J=J_solid(D); r=D/2; }
      else { if(!(isNum(d)&&D>d&&d>0)) return showErr('Need D>d>0'); J=J_tube(D,d); r=D/2; }
      const tau = T*r/J;
      const theta = T*L/(J*G);
      const SF = tauA/tau;
      $q('#t_J').textContent=J.toExponential(5);
      $q('#t_tau').textContent=tau.toFixed(2);
      $q('#t_theta').textContent=theta.toExponential(4);
      $q('#t_sf').textContent=SF.toFixed(3);
    };
  },

  buckling(){
    content.innerHTML = `
      <h1>Euler Column Buckling</h1>
      <fieldset>
        <legend>Geometry & Material</legend>
        <div class="row4">
          <label>Section
            <select id="c_sect"><option value="rect">Rectangle</option><option value="circle">Solid circle</option><option value="tube">Tube</option><option value="custom">Custom (A,I)</option></select>
          </label>
          <label>Dim 1 <input id="c_d1" type="number" step="any" value="0.05"></label>
          <label>Dim 2 <input id="c_d2" type="number" step="any" value="0.10"></label>
          <label>Extra (D/inner) <input id="c_d3" type="number" step="any" value="0.08"></label>
        </div>
        <div class="row4">
          <label>E (GPa) <input id="c_E" type="number" step="any" value="200"></label>
          <label>Length L (m) <input id="c_L" type="number" step="any" value="2"></label>
          <label>Ends (K)
            <select id="c_K">
              <option value="1">Pinned‑Pinned (K=1.0)</option>
              <option value="2">Fixed‑Free (K=2.0)</option>
              <option value="0.7">Fixed‑Pinned (K=0.7)</option>
              <option value="0.5">Fixed‑Fixed (K=0.5)</option>
            </select>
          </label>
          <div style="display:flex;align-items:center"><button class="action" id="c_calc">Calculate</button></div>
        </div>
      </fieldset>
      <h2>Results</h2>
      <div class="row4">
        <div><span class="chip">A</span> <span id="c_A">—</span> m²</div>
        <div><span class="chip">I</span> <span id="c_I">—</span> m⁴</div>
        <div><span class="chip">r</span> <span id="c_r">—</span> m</div>
        <div><span class="chip">λ = KL/r</span> <span id="c_lambda">—</span></div>
      </div>
      <div class="row3">
        <div><span class="chip">P<sub>cr</sub></span> <span id="c_P">—</span> N</div>
        <div><span class="chip">Check</span> <span id="c_note">—</span></div>
        <div></div>
      </div>
    `;
    $q('#c_calc').onclick=()=>{
      const sect=$q('#c_sect').value; const d1=+$q('#c_d1').value, d2=+$q('#c_d2').value, d3=+$q('#c_d3').value;
      const E=+$q('#c_E').value*1e9, L=+$q('#c_L').value, K=+$q('#c_K').value;
      if(![E,L,K].every(isNum)||E<=0||L<=0||K<=0) return showErr('Check E,L,K');
      let A,I;
      if(sect==='rect'){ if(![d1,d2].every(isNum)&&d1>0&&d2>0) return showErr('dims'); A=A_rect(d1,d2); I=I_rect(d1,d2); }
      else if(sect==='circle'){ if(!(isNum(d1)&&d1>0)) return showErr('d'); A=A_circle(d1); I=I_circle(d1); }
      else if(sect==='tube'){ if(!(isNum(d1)&&isNum(d3)&&d1>d3&&d3>0)) return showErr('D>d>0'); A=A_tube(d1,d3); I=I_tube(d1,d3); }
      else { A=+$q('#c_d1').value; I=+$q('#c_d2').value; if(![A,I].every(isNum)&&A>0&&I>0) return showErr('custom A,I'); }
      const r=Math.sqrt(I/A);
      const KL=K*L; const lambda=KL/r;
      const Pcr = Math.PI*Math.PI*E*I/(KL*KL);
      $q('#c_A').textContent=A.toExponential(5);
      $q('#c_I').textContent=I.toExponential(5);
      $q('#c_r').textContent=r.toExponential(5);
      $q('#c_lambda').textContent=lambda.toFixed(1);
      $q('#c_P').textContent=Pcr.toFixed(2);
      $q('#c_note').textContent = lambda>100? 'Long column (Euler likely valid)':'Check end conditions/material yield';
    };
  },

  pressure(){
    content.innerHTML = `
      <h1>Thin‑Wall Pressure Vessels</h1>
      <fieldset>
        <legend>Inputs</legend>
        <div class="row4">
          <label>Geometry <select id="p_geom"><option value="cyl">Cylinder</option><option value="sph">Sphere</option></select></label>
          <label>Internal pressure p (Pa)<input id="p_p" type="number" step="any" value="2e6"></label>
          <label>Radius r (m)<input id="p_r" type="number" step="any" value="0.5"></label>
          <label>Wall thickness t (m)<input id="p_t" type="number" step="any" value="0.01"></label>
        </div>
      </fieldset>
      <button class="action" id="p_calc">Calculate</button>
      <h2>Stresses</h2>
      <div class="row4">
        <div><span class="chip">σ<sub>hoop</sub></span> <span id="p_hoop">—</span> Pa</div>
        <div><span class="chip">σ<sub>long</sub></span> <span id="p_long">—</span> Pa</div>
        <div><span class="chip">σ<sub>sph</sub></span> <span id="p_sph">—</span> Pa</div>
        <div><span class="chip">Thin‑wall check</span> <span id="p_chk">—</span></div>
      </div>
    `;
    $q('#p_calc').onclick=()=>{
      const geom=$q('#p_geom').value, p=+$q('#p_p').value, r=+$q('#p_r').value, t=+$q('#p_t').value;
      if(![p,r,t].every(isNum)||p<=0||r<=0||t<=0) return showErr('Check inputs');
      const hoop = (geom==='cyl')? p*r/t : p*r/(2*t);
      const lon  = (geom==='cyl')? p*r/(2*t) : p*r/(2*t);
      const sph  = p*r/(2*t);
      const thin = (r/t)>=10 ? 'OK (r/t ≥ 10)' : 'May not be thin‑walled';
      $q('#p_hoop').textContent=hoop.toFixed(2);
      $q('#p_long').textContent=lon.toFixed(2);
      $q('#p_sph').textContent=sph.toFixed(2);
      $q('#p_chk').textContent=thin;
    };
  },

  spring(){
    content.innerHTML = `
      <h1>Helical Compression Springs</h1>
      <fieldset>
        <legend>Geometry & Material</legend>
        <div class="row4">
          <label>Wire d (m)<input id="s_d" type="number" step="any" value="0.01"></label>
          <label>Mean D (m)<input id="s_D" type="number" step="any" value="0.05"></label>
          <label>Active coils n<input id="s_n" type="number" step="any" value="8"></label>
          <label>G (GPa)<input id="s_G" type="number" step="any" value="80"></label>
        </div>
        <div class="row3">
          <label>Load P (N)<input id="s_P" type="number" step="any" value="100"></label>
          <div style="display:flex;align-items:center"><button class="action" id="s_calc">Calculate</button></div>
          <div class="note">k = G d⁴ /(8 D³ n). τ = 8 P D /(π d³) · K<sub>W</sub>, K<sub>W</sub> ≈ (4C−1)/(4C−4) + 0.615/C, C=D/d.</div>
        </div>
      </fieldset>
      <h2>Results</h2>
      <div class="row4">
        <div><span class="chip">k</span> <span id="s_k">—</span> N/m</div>
        <div><span class="chip">Deflection</span> <span id="s_x">—</span> m</div>
        <div><span class="chip">τ</span> <span id="s_tau">—</span> Pa</div>
        <div><span class="chip">C</span> <span id="s_C">—</span></div>
      </div>
    `;
    $q('#s_calc').onclick=()=>{
      const d=+$q('#s_d').value, D=+$q('#s_D').value, n=+$q('#s_n').value, G=+$q('#s_G').value*1e9, P=+$q('#s_P').value;
      if(![d,D,n,G,P].every(isNum)||d<=0||D<=0||n<=0||G<=0) return showErr('Check inputs');
      const k = G*Math.pow(d,4)/(8*Math.pow(D,3)*n);
      const x = P/k;
      const C = D/d; const KW = (4*C-1)/(4*C-4) + 0.615/C;
      const tau = (8*P*D)/(Math.PI*Math.pow(d,3))*KW;
      $q('#s_k').textContent=k.toFixed(2);
      $q('#s_x').textContent=x.toExponential(4);
      $q('#s_tau').textContent=tau.toFixed(2);
      $q('#s_C').textContent=C.toFixed(3);
    };
  },

  thermal(){
    content.innerHTML = `
      <h1>Thermal Expansion</h1>
      <fieldset>
        <legend>Inputs</legend>
        <div class="row4">
          <label>α (1/K)<input id="th_alpha" type="number" step="any" value="1.2e-5"></label>
          <label>L (m)<input id="th_L" type="number" step="any" value="1"></label>
          <label>ΔT (K)<input id="th_dT" type="number" step="any" value="50"></label>
          <div style="display:flex;align-items:center"><button class="action" id="th_calc">Calculate</button></div>
        </div>
      </fieldset>
      <div class="row3">
        <div><span class="chip">ΔL</span> <span id="th_dL">—</span> m</div>
        <div><span class="chip">L<sub>final</sub></span> <span id="th_Lf">—</span> m</div>
        <div></div>
      </div>
    `;
    $q('#th_calc').onclick=()=>{ const a=+$q('#th_alpha').value, L=+$q('#th_L').value, dT=+$q('#th_dT').value; if(![a,L,dT].every(isNum)) return showErr('inputs'); const dL=a*L*dT; $q('#th_dL').textContent=dL.toExponential(4); $q('#th_Lf').textContent=(L+dL).toFixed(6); };
  },

  bolts(){
    content.innerHTML = `
      <h1>Bolted Joint Torque (Approx.)</h1>
      <fieldset>
        <legend>Inputs</legend>
        <div class="row4">
          <label>Nominal dia d (m)<input id="bt_d" type="number" step="any" value="0.01"></label>
          <label>Target preload F (kN)<input id="bt_F" type="number" step="any" value="10"></label>
          <label>Nut factor K (0.15–0.25)<input id="bt_K" type="number" step="any" value="0.2"></label>
          <div style="display:flex;align-items:center"><button class="action" id="bt_calc">Calculate</button></div>
        </div>
        <div class="note">T ≈ K·F·d (F in N). Rule‑of‑thumb only; consult bolt standard for precise torque.</div>
      </fieldset>
      <div class="row3">
        <div><span class="chip">Torque T</span> <span id="bt_T">—</span> N·m</div>
        <div><span class="chip">F (N)</span> <span id="bt_Fn">—</span></div>
        <div></div>
      </div>
    `;
    $q('#bt_calc').onclick=()=>{ const d=+$q('#bt_d').value, FkN=+$q('#bt_F').value, K=+$q('#bt_K').value; if(![d,FkN,K].every(isNum)) return showErr('inputs'); const F=FkN*1000; const T=K*F*d; $q('#bt_T').textContent=T.toFixed(2); $q('#bt_Fn').textContent=F.toFixed(0); };
  },

  gears(){
    content.innerHTML = `
      <h1>Gear Ratio & Power Flow</h1>
      <fieldset>
        <legend>Inputs</legend>
        <div class="row4">
          <label>N₁ (driver teeth)<input id="g_N1" type="number" step="any" value="20"></label>
          <label>N₂ (driven teeth)<input id="g_N2" type="number" step="any" value="60"></label>
          <label>n₁ (rpm)<input id="g_n1" type="number" step="any" value="1800"></label>
          <label>T₁ (N·m)<input id="g_T1" type="number" step="any" value="5"></label>
        </div>
        <div class="row3">
          <label>Efficiency η (0–1)<input id="g_eta" type="number" step="any" value="0.95"></label>
          <div style="display:flex;align-items:center"><button class="action" id="g_calc">Calculate</button></div>
          <div class="note">i = N₂/N₁ = n₁/n₂. T₂ ≈ T₁·i·η, Power P ≈ 2π n T / 60.</div>
        </div>
      </fieldset>
      <h2>Results</h2>
      <div class="row4">
        <div><span class="chip">Ratio i</span> <span id="g_i">—</span></div>
        <div><span class="chip">n₂</span> <span id="g_n2">—</span> rpm</div>
        <div><span class="chip">T₂</span> <span id="g_T2">—</span> N·m</div>
        <div><span class="chip">Power (out)</span> <span id="g_Po">—</span> W</div>
      </div>
    `;
    $q('#g_calc').onclick=()=>{ const N1=+$q('#g_N1').value, N2=+$q('#g_N2').value, n1=+$q('#g_n1').value, T1=+$q('#g_T1').value, eta=+$q('#g_eta').value; if(![N1,N2,n1,T1,eta].every(isNum)||N1<=0||N2<=0||eta<=0) return showErr('inputs'); const i=N2/N1; const n2=n1/i; const T2=T1*i*eta; const Po=2*Math.PI*(n2/60)*T2; $q('#g_i').textContent=i.toFixed(3); $q('#g_n2').textContent=n2.toFixed(1); $q('#g_T2').textContent=T2.toFixed(2); $q('#g_Po').textContent=Po.toFixed(1); };
  },

  vibe(){
    content.innerHTML = `
      <h1>Single‑DOF Vibration</h1>
      <fieldset>
        <legend>Inputs</legend>
        <div class="row4">
          <label>Mass m (kg)<input id="v_m" type="number" step="any" value="10"></label>
          <label>Stiffness k (N/m)<input id="v_k" type="number" step="any" value="2000"></label>
          <label>Damping ζ (0–1)<input id="v_z" type="number" step="any" value="0.05"></label>
          <div style="display:flex;align-items:center"><button class="action" id="v_calc">Calculate</button></div>
        </div>
      </fieldset>
      <div class="row4">
        <div><span class="chip">ωₙ</span> <span id="v_wn">—</span> rad/s</div>
        <div><span class="chip">fₙ</span> <span id="v_fn">—</span> Hz</div>
        <div><span class="chip">f_d</span> <span id="v_fd">—</span> Hz</div>
        <div><span class="chip">Note</span> <span id="v_note">—</span></div>
      </div>
    `;
    $q('#v_calc').onclick=()=>{ const m=+$q('#v_m').value, k=+$q('#v_k').value, z=+$q('#v_z').value; if(![m,k,z].every(isNum)||m<=0||k<=0||z<0||z>=1) return showErr('inputs'); const wn=Math.sqrt(k/m); const fn=wn/(2*Math.PI); const fd=fn*Math.sqrt(1-z*z); $q('#v_wn').textContent=wn.toFixed(3); $q('#v_fn').textContent=fn.toFixed(3); $q('#v_fd').textContent=fd.toFixed(3); $q('#v_note').textContent=z<0.01?'Lightly damped':'—'; };
  },

  convert(){
    content.innerHTML = `
      <h1>Unit Converters</h1>
      <fieldset>
        <legend>Length</legend>
        <div class="row4">
          <label>m <input id="u_m" type="number" step="any"></label>
          <label>mm <input id="u_mm" type="number" step="any"></label>
          <label>in <input id="u_in" type="number" step="any"></label>
          <label>ft <input id="u_ft" type="number" step="any"></label>
        </div>
      </fieldset>
      <fieldset>
        <legend>Force</legend>
        <div class="row4">
          <label>N <input id="u_N" type="number" step="any"></label>
          <label>kN <input id="u_kN" type="number" step="any"></label>
          <label>lbf <input id="u_lbf" type="number" step="any"></label>
          <label>kgf <input id="u_kgf" type="number" step="any"></label>
        </div>
      </fieldset>
      <fieldset>
        <legend>Stress</legend>
        <div class="row4">
          <label>Pa <input id="u_Pa" type="number" step="any"></label>
          <label>MPa <input id="u_MPa" type="number" step="any"></label>
          <label>psi <input id="u_psi" type="number" step="any"></label>
          <label>ksi <input id="u_ksi" type="number" step="any"></label>
        </div>
      </fieldset>
      <fieldset>
        <legend>Torque</legend>
        <div class="row4">
          <label>N·m <input id="u_Nm" type="number" step="any"></label>
          <label>kN·m <input id="u_kNm" type="number" step="any"></label>
          <label>lbf·ft <input id="u_lbfft" type="number" step="any"></label>
          <label>lbf·in <input id="u_lbfin" type="number" step="any"></label>
        </div>
      </fieldset>
    `;
    const $=id=>content.querySelector(id);
    const set=(id,val)=>{ const el=$(id); if(document.activeElement!==el) el.value=(isNum(val)? val:''); };
    // Length
    $('#u_m').addEventListener('input',()=>{ const v=parseFloat($('#u_m').value); if(!isNum(v)) return; set('#u_mm', v*1000); set('#u_in', v*39.3700787); set('#u_ft', v*3.2808399); });
    $('#u_mm').addEventListener('input',()=>{ const v=parseFloat($('#u_mm').value); if(!isNum(v)) return; set('#u_m', v/1000); set('#u_in', v*0.0393700787); set('#u_ft', v*0.0032808399); });
    $('#u_in').addEventListener('input',()=>{ const v=parseFloat($('#u_in').value); if(!isNum(v)) return; set('#u_m', v/39.3700787); set('#u_mm', v*25.4); set('#u_ft', v/12); });
    $('#u_ft').addEventListener('input',()=>{ const v=parseFloat($('#u_ft').value); if(!isNum(v)) return; set('#u_m', v/3.2808399); set('#u_mm', v*304.8); set('#u_in', v*12); });
    // Force
    $('#u_N').addEventListener('input',()=>{ const v=+$('#u_N').value; if(!isNum(v)) return; set('#u_kN', v/1000); set('#u_lbf', v/4.4482216153); set('#u_kgf', v/9.80665); });
    $('#u_kN').addEventListener('input',()=>{ const v=+$('#u_kN').value; if(!isNum(v)) return; set('#u_N', v*1000); set('#u_lbf', v*1000/4.4482216153); set('#u_kgf', v*1000/9.80665); });
    $('#u_lbf').addEventListener('input',()=>{ const v=+$('#u_lbf').value; if(!isNum(v)) return; set('#u_N', v*4.4482216153); set('#u_kN', v*4.4482216153/1000); set('#u_kgf', v*4.4482216153/9.80665); });
    $('#u_kgf').addEventListener('input',()=>{ const v=+$('#u_kgf').value; if(!isNum(v)) return; set('#u_N', v*9.80665); set('#u_kN', v*9.80665/1000); set('#u_lbf', v*9.80665/4.4482216153); });
    // Stress
    $('#u_Pa').addEventListener('input',()=>{ const v=+$('#u_Pa').value; if(!isNum(v)) return; set('#u_MPa', v/1e6); set('#u_psi', v/6894.75729); set('#u_ksi', (v/6894.75729)/1000); });
    $('#u_MPa').addEventListener('input',()=>{ const v=+$('#u_MPa').value; if(!isNum(v)) return; set('#u_Pa', v*1e6); set('#u_psi', v*1e6/6894.75729); set('#u_ksi', (v*1e6/6894.75729)/1000); });
    $('#u_psi').addEventListener('input',()=>{ const v=+$('#u_psi').value; if(!isNum(v)) return; set('#u_Pa', v*6894.75729); set('#u_MPa', v*6894.75729/1e6); set('#u_ksi', v/1000); });
    $('#u_ksi').addEventListener('input',()=>{ const v=+$('#u_ksi').value; if(!isNum(v)) return; set('#u_psi', v*1000); set('#u_Pa', v*1000*6894.75729); set('#u_MPa', v*1000*6894.75729/1e6); });
    // Torque
    $('#u_Nm').addEventListener('input',()=>{ const v=+$('#u_Nm').value; if(!isNum(v)) return; set('#u_kNm', v/1000); set('#u_lbfft', v*0.737562149); set('#u_lbfin', v*8.85074579); });
    $('#u_kNm').addEventListener('input',()=>{ const v=+$('#u_kNm').value; if(!isNum(v)) return; set('#u_Nm', v*1000); set('#u_lbfft', v*1000*0.737562149); set('#u_lbfin', v*1000*8.85074579); });
    $('#u_lbfft').addEventListener('input',()=>{ const v=+$('#u_lbfft').value; if(!isNum(v)) return; set('#u_Nm', v/0.737562149); set('#u_kNm', v/0.737562149/1000); set('#u_lbfin', v*12); });
    $('#u_lbfin').addEventListener('input',()=>{ const v=+$('#u_lbfin').value; if(!isNum(v)) return; set('#u_Nm', v/8.85074579); set('#u_kNm', v/8.85074579/1000); set('#u_lbfft', v/12); });
  }
};

function show(view){
  views[view]();
  document.querySelectorAll('.nav button').forEach(b=>{
    b.setAttribute('aria-current', b.dataset.view===view? 'page': 'false');
  });
  setTimeout(()=>{ const first = content.querySelector('input,select,button'); if(first) first.focus(); }, 0);
}

document.querySelector('.nav').addEventListener('click', (e)=>{ const b = e.target.closest('button[data-view]'); if(!b) return; show(b.dataset.view); });
window.addEventListener('keydown', (e)=>{ if(e.key==='/'){ e.preventDefault(); const i=content.querySelector('input,select,button'); if(i) i.focus(); } });

// Start
show('beam');
</script>
</body>
</html>

